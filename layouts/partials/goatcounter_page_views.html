{{/* HTML to display the count */}}
<span class="page-view-counter">
    <span id="page-views-{{ .File.UniqueID }}">...</span> views
</span>

<script>
    var statsElementId = "page-views-{{ .File.UniqueID }}";
    // Use .RelPermalink and remove trailing slash for path uniformity
    var path = "{{ .RelPermalink | default .Permalink }}";
    if (path.endsWith('/')) { path = path.slice(0, -1); }

    var r = new XMLHttpRequest;

    r.addEventListener("load", function () {
        var stats = JSON.parse(this.responseText);

        // Only display if the unique count is greater than zero
        if (stats && stats.count_unique > 0) {
            document.getElementById(statsElementId).innerText = stats.count_unique.toLocaleString();
        } else {
            // Hide the counter if no data is found or the count is 0
            document.querySelector(".page-view-counter").style.display = "none";
        }
    });

    // CRITICAL: Request the JSON data endpoint
    r.open("GET", "https://pporeddy.goatcounter.com/counter/" + encodeURIComponent(path) + ".json");
    r.send();
</script>